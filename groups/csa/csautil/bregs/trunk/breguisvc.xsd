<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:tns="urn:x-bloomberg-com:BAS.services.breguisvc"
    xmlns:bdem="http://bloomberg.com/schemas/bdem"
    elementFormDefault="qualified"
    targetNamespace="urn:x-bloomberg-com:BAS.services.breguisvc"
    bdem:requestType='Request' bdem:responseType='Response'
    bdem:serviceInfo='breguisvc:64730-1.11'
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

    <xs:complexType name="Void">
        <xs:sequence />
    </xs:complexType>

    <xs:complexType name="ErrorInfoResponse">
        <xs:sequence>
            <xs:element name="code" type="xs:int" />
            <xs:element name="message" type="xs:string" />
        </xs:sequence>
    </xs:complexType>

    <xs:simpleType name="ValueType" bdem:preserveEnumOrder="1">
        <xs:restriction base="xs:string">
            <xs:enumeration value="Unknown" />
            <xs:enumeration value="Boolean" />
            <xs:enumeration value="Integer" />
            <xs:enumeration value="Character" />
            <xs:enumeration value="Double" />
            <xs:enumeration value="List of Integers" />
            <xs:enumeration value="String" />
            <xs:enumeration value="Ext List of Integers" />
            <xs:enumeration value="Extended String" />

            <!-- Table value types -->
            <xs:enumeration value="Integer Table" />
            <xs:enumeration value="Character Table" />
            <xs:enumeration value="Boolean Table" />
            <xs:enumeration value="String Table" />
            <xs:enumeration value="List of Integers Table" />
            <xs:enumeration value="Double Table" />
        </xs:restriction>
    </xs:simpleType>

    <xs:simpleType name="OverrideType" bdem:preserveEnumOrder="1">
        <xs:restriction base="xs:string">
            <xs:enumeration value="Unknown" />
            <xs:enumeration value="Machine or Group" />
            <xs:enumeration value="Customer" />
            <xs:enumeration value="UUID" />
            <xs:enumeration value="Firm Number" />
            <xs:enumeration value="TS Pricing Number" />
            <xs:enumeration value="Department Code" />
            <xs:enumeration value="Serial Number" />
            <xs:enumeration value="Pindex" />
            <xs:enumeration value="UUID Percent" />
        </xs:restriction>
    </xs:simpleType>

    <xs:complexType name="OverrideSummary">
        <xs:sequence>
            <xs:element name="type" type="xs:int" />
            <xs:element name="typeString" type="xs:string" />
            <xs:element name="typeEnum" type="tns:OverrideType" />
            <xs:element name="setting" type="xs:string" />
            <xs:element name="settingTooltip" type="xs:string" />
            <xs:element name="value" type="xs:string" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="Node">
        <xs:sequence>
            <xs:element name="name" type="xs:string" />
            <xs:element name="id" type="xs:int" />
            <xs:element name="type" type="xs:int" />
            <xs:element name="description" type="xs:string" />
            <xs:element name="hasExpired" type="xs:boolean" />
            <xs:element name="expiryTsp" type="xs:string" />
            <xs:element name="children" type="tns:Node" minOccurs="0" maxOccurs="unbounded" />
            <xs:element name="obsoleteTraceEnabled" type="xs:boolean" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="NodeDetails">
        <xs:sequence>
            <xs:element name="name" type="xs:string" />
            <xs:element name="id" type="xs:int" />
            <xs:element name="type" type="xs:int" />
            <xs:element name="description" type="xs:string" />

            <!-- description fields -->
            <xs:element name="accessor" type="xs:string" />
            <xs:element name="updateTsp" type="xs:string" />

            <xs:element name="valueType" type="xs:int" /> 
            <xs:element name="valueTypeString" type="xs:string" />
            <xs:element name="valueTypeEnum" type="tns:ValueType" /> 
            <xs:element name="isInMemory" type="xs:boolean" />
            <xs:element name="isInMemoryString" type="xs:string" />
            
            <xs:element name="hasExpired" type="xs:boolean" />
            <xs:element name="expiryTsp" type="xs:string" />
            <xs:element name="isPermanent" type="xs:boolean" />
            <xs:element name="isPermanentString" type="xs:string" />
            <xs:element name="keywords" type="xs:string" />

            <!-- prod value fields -->
            <xs:element name="inProd" type="xs:boolean" />
            <xs:element name="prodValue" type="xs:string" />
            <xs:element name="prodVersion" type="xs:int" />
            <xs:element name="prodOverrides" type="tns:OverrideSummary" minOccurs="0" maxOccurs="unbounded" />

            <!-- dev value fields -->
            <xs:element name="inTest" type="xs:boolean" />
            <xs:element name="testValue" type="xs:string" />
            <xs:element name="testOverrides" type="tns:OverrideSummary" minOccurs="0" maxOccurs="unbounded" />

            <!-- privilege fields -->
            <xs:element name="canAddNode" type="xs:boolean" />
            <xs:element name="canAddEntry" type="xs:boolean" />

            <xs:element name="prodObsoleteTraceEnabled" type="xs:boolean" />
            <xs:element name="devObsoleteTraceEnabled" type="xs:boolean" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="SearchByContacts">
        <xs:sequence>
            <xs:element name="uuid" type="xs:int" />
            <xs:element name="contactType" type="xs:int" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="SearchByKeywords">
        <xs:sequence>
            <xs:element name="keywords" type="xs:string" maxOccurs="unbounded" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="BregValueObject">
        <xs:choice>
            <xs:element name="id" type="xs:int" />
            <xs:element name="gobxml" type="xs:string" />
        </xs:choice>
    </xs:complexType>

    <xs:complexType name="EvaluateOverrides">
        <xs:sequence>
            <xs:element name="p6uuid" type="xs:int" minOccurs="0" />
            <xs:element name="p3firm" type="xs:int" minOccurs="0" />
            <xs:element name="p3cust" type="xs:int" minOccurs="0" />
            <xs:element name="p3prcnum" type="xs:int" minOccurs="0" />
            <xs:element name="p3sn" type="xs:int" minOccurs="0" />
            <xs:element name="p9departmentcode" type="xs:string" minOccurs="0" />
            <xs:element name="pindex" type="xs:int" minOccurs="0" />
            <xs:element name="uuidprc" type="xs:int" minOccurs="0" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="GetBregValuesRequest">
        <xs:sequence>
            <xs:element name="object" type="tns:BregValueObject" />
            <xs:element name="overrides" type="tns:EvaluateOverrides" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="BregValue">
        <xs:sequence>
            <xs:element name="id" type="xs:int" />
            <xs:element name="valueType" type="xs:int" />
            <xs:element name="valueTypeString" type="xs:string" />
            <xs:element name="typeString" type="xs:string" />
            <xs:element name="accessor" type="xs:string" />
            <xs:element name="value" type="xs:string" />
        </xs:sequence>
    </xs:complexType>

    <!-- Begin added for new UI -->
	<xs:simpleType name="EventTypeEnum">
		<xs:annotation>
			<xs:documentation>Types of events</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:integer">
			<xs:minInclusive value="0"/>
			<xs:maxInclusive value="99"/>
		</xs:restriction>
	</xs:simpleType>

	<xs:simpleType name="ApiStatus" bdem:preserveEnumOrder="1">
		<xs:annotation>
			<xs:documentation>ApiStatus</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="New"/>
			<xs:enumeration value="Staged"/>
			<xs:enumeration value="Released"/>
		</xs:restriction>
	</xs:simpleType>

	<xs:simpleType name="AclType" bdem:preserveEnumOrder="1">
		<xs:annotation>
			<xs:documentation>Acl Types</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="Update Description"/>
			<xs:enumeration value="Release Code"/>
			<xs:enumeration value="Privileging Admin"/>
			<xs:enumeration value="Update Production Values"/>
			<xs:enumeration value="Update Dev Values"/>
		</xs:restriction>
	</xs:simpleType>

	<xs:simpleType name="InheritanceType" bdem:preserveEnumOrder="1">
		<xs:annotation>
			<xs:documentation>Inheritance Types</xs:documentation>
		</xs:annotation>
		<xs:restriction base="xs:string">
			<xs:enumeration value="Use Parent Node"/>
			<xs:enumeration value="Use Instead of Parent Node"/>
			<xs:enumeration value="Use in Addition to Parent Node"/>
		</xs:restriction>
	</xs:simpleType>

	<xs:complexType name="EntryData">
		<xs:choice>
			<xs:element name="Bool" type="xs:boolean"/>
			<xs:element name="Double" type="xs:double"/>
			<xs:element name="Int" type="xs:integer"/>
			<xs:element name="IntList" type="xs:integer" maxOccurs="unbounded"/>
			<xs:element name="Char" type="xs:string"/>
			<xs:element name="Str" type="xs:string"/>
			<xs:element name="ExtIntList" type="xs:integer" maxOccurs="unbounded"/>
			<xs:element name="ExtString" type="xs:string"/>
		</xs:choice>
	</xs:complexType>

	<xs:complexType name="EntryOverride">
		<xs:sequence>
			<xs:element name="seq" type="xs:integer"/>
			<xs:element name="type" type="tns:OverrideType"/>
			<xs:element name="value" type="xs:string"/>
			<xs:element name="entryData" type="tns:EntryData"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="AuditRecord">
		<xs:sequence>
			<xs:element name="entryId" type="xs:integer"/>
			<xs:element name="prqsNumber" type="xs:integer"/>
			<xs:element name="prqsStatus" type="xs:string"/>
			<xs:element name="uuid" type="xs:integer"/>
			<xs:element name="updateTsp" type="xs:string"/>
			<xs:element name="eventType" type="tns:EventTypeEnum"/>
			<xs:element name="oldValue" type="xs:integer"/>
			<xs:element name="newValue" type="xs:integer"/>
			<xs:element name="ticketType" type="xs:integer"/>
			<xs:element name="ticketNumber" type="xs:integer"/>
			<xs:element name="logNote" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="NodePrivilege">
		<xs:sequence>
            <!-- privilege fields -->
            <xs:element name="isPrivilegeAdmin" type="xs:boolean" />
            <xs:element name="canUpdateProd" type="xs:boolean" />
            <xs:element name="canUpdateDesc" type="xs:boolean" />
            <xs:element name="canReleaseCode" type="xs:boolean" />
            <xs:element name="canUpdateDev"  type="xs:boolean" />
        </xs:sequence>
    </xs:complexType>

	<xs:complexType name="NodeInfo">
		<xs:sequence>
			<xs:element name="nodeId" type="xs:integer"/>
			<xs:element name="parentId" type="xs:integer"/>
			<xs:element name="name" type="xs:string"/>
			<xs:element name="description" type="xs:string"/>
			<xs:element name="isLeaf" type="xs:boolean"/>
			<xs:element name="isDeleted" type="xs:boolean"/>
			<xs:element name="auditRecord" type="tns:AuditRecord"/>
			<xs:element name="keywords" type="xs:string" minOccurs="0" maxOccurs="unbounded" />
			<xs:element name="privilege" type="tns:NodePrivilege" />
			<xs:element name="contacts" type="tns:EntryContacts" />
                        <xs:element name="isToDelete" type="xs:boolean" />
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="EntryInfo">
		<xs:sequence>
			<xs:element name="entryId" type="xs:integer"/>
			<xs:element name="currentVersion" type="xs:integer"/>
			<xs:element name="valueType" type="tns:ValueType"/>
			<xs:element name="apiName" type="xs:string"/>
			<xs:element name="apiStatus" type="tns:ApiStatus"/>
			<xs:element name="expiryTsp" type="xs:string"/>
			<xs:element name="isPermanent" type="xs:boolean"/>
			<xs:element name="isSharedMemory" type="xs:boolean"/>
            <!-- these are deprecated now
			<xs:element name="isMacro" type="xs:boolean"/>
			<xs:element name="hasDefaultValue" type="xs:boolean"/>
			<xs:element name="defaultBoolValue" type="xs:boolean"/>
            -->
			<xs:element name="maxNumValuesInList" type="xs:integer"/>
			<xs:element name="pwhoId" type="xs:integer"/>
			<xs:element name="apiDate" type="xs:integer" minOccurs="0" maxOccurs="1"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="RegistryInfo">
		<xs:sequence>
			<xs:element name="node" type="tns:NodeInfo"/>
			<xs:element name="entry" type="tns:EntryInfo" minOccurs="0" maxOccurs="1" />
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="EntryValue">
		<xs:sequence>
			<xs:element name="entryId" type="xs:integer"/>
			<xs:element name="version" type="xs:integer"/>
			<xs:element name="entryData" type="tns:EntryData" minOccurs="0"/>
			<xs:element name="entryOverrides" type="tns:EntryOverride" minOccurs="0" maxOccurs="unbounded"/>
			<xs:element name="isObsolete" type="xs:boolean"/>
			<xs:element name="isSharedMemory" type="xs:boolean"/>
			<xs:element name="auditRecord" type="tns:AuditRecord"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="EntryContacts">
		<xs:sequence>
			<xs:element name="primaryUuid" type="xs:integer"/>
			<xs:element name="backupUuid" type="xs:integer"/>
			<xs:element name="operationalUuid" type="xs:integer"/>
			<xs:element name="drqsGroup" type="xs:integer"/>
			<xs:element name="auditRecord" type="tns:AuditRecord"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="EntrySubscribers">
		<xs:sequence>
			<xs:element name="registryId" type="xs:integer" />
			<xs:element name="userDataList" type="tns:UserData" maxOccurs="unbounded"/>
			<xs:element name="auditRecord" type="tns:AuditRecord"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="UserData">
		<xs:sequence>
			<xs:element name="userFlags" type="xs:integer" maxOccurs="unbounded" />
			<xs:element name="userNumber" type="xs:integer"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="VersionTsp">
		<xs:sequence>
			<xs:element name="version" type="xs:integer"/>
			<xs:element name="updateEpoch" type="xs:int"/>
			<xs:element name="prqsNumber" type="xs:int"/>
            <xs:element name="prqsStatus" type="xs:string"/>
            <xs:element name="updateTsp" type="xs:string"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="VersionHistory">
		<xs:sequence>
			<xs:element name="versionHistory" type="tns:VersionTsp" minOccurs="0" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="PrivilegeList">
		<xs:sequence>
            <xs:element name="registryId" type="xs:int"/>
			<xs:element name="userDataList" type="tns:UserData" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>

    <xs:complexType name="ValueRequest">
        <xs:sequence>
            <xs:element name="entryId" type="xs:int"/>
            <xs:element name="version" type="xs:int"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="MoveRequest">
        <xs:sequence>
            <xs:element name="registryId" type="xs:int"/>
            <xs:element name="moveToNodeId" type="xs:int"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="UpdateContactRequest">
        <xs:sequence>
            <xs:element name="registryId" type="xs:int"/>
            <xs:element name="contacts" type="tns:EntryContacts"/>
			<xs:element name="auditRecord" type="tns:AuditRecord"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="Group">
        <xs:sequence>
            <xs:element name="groupId" type="xs:int"/>
            <xs:element name="groupDescription" type="xs:string"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="OverrideInfo">
		<xs:annotation>
            <xs:documentation>For override validation</xs:documentation>
		</xs:annotation>
        <xs:sequence>
            <xs:element name="isProduction" type="xs:boolean"/>
            <xs:element name="type" type="tns:OverrideType"/>
			<xs:element name="setting" type="xs:string"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="GenerateCodeRequest">
        <xs:sequence>
            <xs:element name="registry" type="tns:RegistryInfo"/>
            <xs:element name="entryValue" type="tns:EntryValue"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="BregChangeRequest">
        <xs:sequence>
            <xs:element name="approverUuid" type="xs:int" />
            <xs:element name="registry" type="tns:RegistryInfo"/>
            <xs:element name="entryValue" type="tns:EntryValue"/>
            <xs:element name="prqsPriority" type="xs:int" />
            <xs:element name="covgRequired" type="xs:boolean" />
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="TodoListItem">
        <xs:sequence>
            <xs:element name="ticketNumber" type="xs:int"/>
            <xs:element name="ticketType" type="xs:string"/>
            <xs:element name="drqsType" type="xs:string"/>
            <xs:element name="status" type="xs:string"/>
            <xs:element name="summary" type="xs:string"/>
        </xs:sequence>
    </xs:complexType>

	<xs:complexType name="TodoList">
		<xs:sequence>
			<xs:element name="list" type="tns:TodoListItem" maxOccurs="unbounded"/>
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="RelatedTicketRequest">
		<xs:sequence>
			<xs:element name="type" type="xs:string" />
			<xs:element name="number" type="xs:int" />
		</xs:sequence>
	</xs:complexType>

	<xs:complexType name="MarkForDeletionRequest">
		<xs:sequence>
			<xs:element name="entryId" type="xs:int" />
			<xs:element name="updateUuid" type="xs:int" />
		</xs:sequence>
	</xs:complexType>

    <!-- End added for new UI -->
    <xs:complexType name="Request">
        <xs:choice>
            <xs:element name="getTree" type="xs:int" />
            <xs:element name="getExpandedTree" type="xs:int" />
            <xs:element name="getDefaultTree" type="tns:Void" />
            <xs:element name="getChildren" type="xs:int" />
            <xs:element name="getDefaultNode" type="tns:Void" />
            <xs:element name="getNodeDetails" type="xs:int" />
            <xs:element name="setDefaultNode" type="xs:int" />
            <xs:element name="searchByName" type="xs:string" />
            <xs:element name="searchById" type="xs:int" />
            <xs:element name="searchByAccessor" type="xs:string" />
            <xs:element name="searchByContacts" type="tns:SearchByContacts" />
            <xs:element name="searchByKeywords" type="tns:SearchByKeywords" />
            <xs:element name="searchByDrqsGroup" type="xs:int" />
            <xs:element name="isDeleted" type="xs:int" />
            <xs:element name="getBregValues" type="tns:GetBregValuesRequest" />
            <!-- BEGIN added -->
            <xs:element name="getRegistry"    type="xs:int"/>
            <xs:element name="getEntryValue"  type="tns:ValueRequest"/>
            <xs:element name="getSubscribers" type="xs:int"/> 
			<xs:element name="getVersionHistory"  type="xs:int"/>
            <xs:element name="updateRegistry"  type="tns:RegistryInfo"/>
            <xs:element name="deleteNode"  type="xs:int"/>
            <xs:element name="moveRegistry"  type="tns:MoveRequest"/>
            <xs:element name="updateContact"  type="tns:UpdateContactRequest"/>
            <xs:element name="getPrivilegeList"  type="xs:int"/>
            <xs:element name="updateSubscribers" type="tns:EntrySubscribers"/>
            <xs:element name="updatePrivileges" type="tns:PrivilegeList"/>
            <xs:element name="getOutGroup"  type="xs:int"/>
            <xs:element name="getDeptChain"  type="xs:int"/>
            <xs:element name="getDrqsGroup"  type="xs:int"/>
            <xs:element name="updateDevValue"  type="tns:EntryValue"/>
            <xs:element name="getMachineGroupName"  type="xs:int"/>
            <xs:element name="validateOverride"  type="tns:OverrideInfo"/>
            <xs:element name="generateCode"  type="tns:GenerateCodeRequest"/>
            <xs:element name="releaseCode"  type="tns:BregChangeRequest"/>
            <xs:element name="getTodoList"  type="xs:int"/>
            <xs:element name="getRelatedTicket"  type="tns:RelatedTicketRequest"/>
            <xs:element name="getNodeType"  type="xs:int"/>
            <xs:element name="changeBreg"  type="tns:BregChangeRequest"/>
            <xs:element name="validatePrqsApprover"  type="tns:BregChangeRequest"/>
            <xs:element name="generateReleaseCode" type="tns:BregChangeRequest"/>
            <xs:element name="markForDeletion" type="tns:MarkForDeletionRequest"/>            <!-- END added -->
        </xs:choice>
    </xs:complexType>

    <xs:complexType name="Response">
        <xs:choice>
            <xs:element name="errorResponse" type="tns:ErrorInfoResponse" />
            <xs:element name="nodeTree" type="tns:Node" maxOccurs="unbounded" />
            <xs:element name="nodeDetails" type="tns:NodeDetails" />
            <xs:element name="nodeId" type="xs:int" />
            <xs:element name="values" type="tns:BregValue" maxOccurs="unbounded" />
            <!-- BEGIN added -->
            <xs:element name="nodeInfo"   type="tns:NodeInfo"/>
            <xs:element name="entryInfo"  type="tns:EntryInfo"/>
            <xs:element name="registryInfo"  type="tns:RegistryInfo"/>
            <xs:element name="entryValue" type="tns:EntryValue"/>
            <xs:element name="entrySubscribers" type="tns:EntrySubscribers"/>
			<xs:element name="versionHistory" type="tns:VersionTsp" maxOccurs="unbounded" />
            <xs:element name="privilegeList"  type="tns:PrivilegeList"/>
            <xs:element name="outGroup" type="tns:Group" />
            <xs:element name="deptChain" type="tns:Group" maxOccurs="unbounded" />
            <xs:element name="drqsGroup" type="tns:Group" />
            <xs:element name="machineGroup" type="xs:string" />
            <xs:element name="todoList" type="tns:TodoList" />
            <xs:element name="relatedTicketSummary" type="xs:string" />
            <xs:element name="nodeType" type="xs:string" />
            <!-- END added -->
        </xs:choice>
    </xs:complexType>

    <xs:element name="request" type="tns:Request" />
    <xs:element name="response" type="tns:Response" />
</xs:schema>

<!-- This schema is created with Visual Schema Editor. -->
